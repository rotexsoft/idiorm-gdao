<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Leanorm by rotexsoft</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Leanorm</h1>
      <h2 class="project-tagline">[WARNING NOT YET PRODUCTION READY: Should be ready in September 2015] A Generic Data Objects (GDAO https://github.com/rotexsoft/gdao ) implementation based on a stripped down (really minimal) version of idiorm.</h2>
      <a href="https://github.com/rotexsoft/leanorm" class="btn">View on GitHub</a>
      <a href="https://github.com/rotexsoft/leanorm/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/rotexsoft/leanorm/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="why-another-php-orm-object-relational-mapping-package" class="anchor" href="#why-another-php-orm-object-relational-mapping-package" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why another PHP ORM (Object-Relational Mapping) Package?</h2>

<p>This package and its parent package <a href="https://github.com/rotexsoft/gdao">Generic Data Access Objects (GDAO)</a> were birthed out of my experience working with some of the existing PHP ORMs like <a href="http://solarphp.com/apidoc/package.Solar_Sql_Model">Solar_Sql_Model</a>, <a href="http://j4mie.github.io/idiormandparis/">Paris</a> and <a href="http://propelorm.org/">Propel</a>. </p>

<p>I have been working on a web-app that's about 6 years old now. The Model layer for this application is powered by the Solar_Sql_Model ORM package. The TableDataGateway and DataMapper patterns implemented in the Solar_Sql_Model package have worked really well for me especially with regards to organizing the code in the <strong>Model</strong> layer of the application (having Model classes (one per database table) that talk to the database, Record classes that hold each row of data retrieved from database tables and Collection classes that hold one or more instances of Record classes containing data associated with a database table). I began to run into some performance problems over time and I started looking for a more performant PHP Orm package to replace the Solar_Sql_Model package in the application. In addition, the Solar_Sql_Model package is part of the Solar PHP framework and cannot be used in web-apps that are not built with the Solar PHP framework. I looked at the Paris Orm, which is actually more lightweight and performant than the Solar_Sql_Model package but was difficult to adapt to the existing Model layer architecture of my application, since Paris is based on the <strong>Active Record</strong> pattern (where records contain data, data access &amp; manipulation logic and business logic). Laravel's Eloquent Orm was also out of the question; since it's also an <strong>Active Record</strong> implementation. Propel and Doctrine were too heavy for my needs (lots of functionality in their code-bases that I may never use).</p>

<p>I decided to write an ORM that handles the common tasks of Inserting, Updating, Retrieving and Deleting data from a database and also supports relationships between database tables (ie. has-one, has-many, has-many-through and belongs-to) using the same pattern in the Solar_Sql_Model package, but without all the database schema management functionality (eg. auto-creation of database tables from PHP source code, altering table schema and the likes). The goal is to have the ORM layer as thin as possible and very close to the PDO layer in PHP (ie. very little overhead added by the Orm when compared to using pure PDO for data access).</p>

<p>I wrote the  <a href="https://github.com/rotexsoft/gdao">Generic Data Access Objects (GDAO)</a> package as a reference package that can be used to build the kind of Orm described above. The GDAO package contains an abstract Model class with methods (abstract and non-abstract) that perform the common data manipulation tasks and two interfaces (CollectionInterface and RecordInterface) that can be used to implement classes that act as collections and records to be used in conjunction with the a concrete implementation of the abstract Model class. Leanorm implements these interfaces and also contains a Model class that is a concrete implementation of \GDAO\Model. The Leanorm code-base is small (it contains a Model class, a Collection class, two Record classes, a Database class used by the Model class for connecting to the database and executing queries and a File containing Exception class definitions) and easy to understand and also easy to extend in order to add additional functionality.</p>

<h3>
<a id="installation--requirements" class="anchor" href="#installation--requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation &amp; Requirements</h3>

<ul>
<li>
<p>This library requires PHP 5.3 or later. It is currently only installable via composer:</p>

<p><code>composer require rotexsoft/leanorm</code></p>
</li>
<li><p>Each table in your database is expected to have a single auto-incrementing numeric primary key column (composite primary keys are not supported).</p></li>
</ul>

<h3>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h3>

<p>All examples are based on the schema below:</p>

<p><img src="non-autogen-assets/images/blog-db.svg?raw=true" alt="Sample Blog Database Schema"></p>

<h3>
<a id="defining-and-creating-model-objects" class="anchor" href="#defining-and-creating-model-objects" aria-hidden="true"><span class="octicon octicon-link"></span></a>Defining and Creating Model Objects</h3>

<p>There are two basic ways to use this package:</p>

<ul>
<li>
<p>Create Model classes for each database table in your application's database. Each of these classes must extend <strong>\LeanOrm\Model</strong>. This is the recommended approach for large applications. An example of a Model class (<em>AuthorsModel</em>) associated  with an <strong>authors</strong> table in the database:</p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">AuthorsModel</span> <span class="pl-k">extends</span> <span class="pl-c1">\LeanOrm\</span><span class="pl-e">Model</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1"><span class="pl-k">protected</span> <span class="pl-smi">$_collection_class_name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>AuthorsCollection<span class="pl-pds">'</span></span>; <span class="pl-c">//If not set, \LeanOrm\Model\Collection will be used by default </span></span>
<span class="pl-s1"><span class="pl-k">protected</span> <span class="pl-smi">$_record_class_name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>AuthorRecord<span class="pl-pds">'</span></span>; <span class="pl-c">//If not set, \LeanOrm\Model\Record will be used by default </span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">protected</span> <span class="pl-smi">$_created_timestamp_column_name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1"><span class="pl-k">protected</span> <span class="pl-smi">$_updated_timestamp_column_name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>m_timestamp<span class="pl-pds">'</span></span>; </span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">protected</span> <span class="pl-smi">$_primary_col</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1"><span class="pl-k">protected</span> <span class="pl-smi">$_table_name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>authors<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">protected</span> <span class="pl-smi">$_relations</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-c">//Entry below specifies that an author can have one or more posts (ie. a has-many relationship).</span></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>relation_type<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">\LeanOrm\</span><span class="pl-c1">Model</span><span class="pl-k">::</span><span class="pl-c1">RELATION_TYPE_HAS_MANY</span>,</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_key_col_in_my_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_key_col_in_foreign_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>primary_key_col_in_foreign_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>post_id<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_models_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>PostsModel<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_models_collection_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>PostsCollection<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_models_record_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>PostRecord<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">            ]</span>
<span class="pl-s1">];</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//create the model object</span></span>
<span class="pl-s1"><span class="pl-smi">$authors_model</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">AuthorsModel</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">"</span>mysql:some-host-name;dbname=blog<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">"</span>username<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1">        [<span class="pl-c1">PDO</span><span class="pl-k">::</span><span class="pl-c1">MYSQL_ATTR_INIT_COMMAND</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>SET NAMES utf8<span class="pl-pds">'</span></span>]</span>
<span class="pl-s1">    );</span>
<span class="pl-s1"></span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p>Or create instances of <strong>\LeanOrm\Model</strong> (one for each database table in your application's database). This approach is good for small to medium sized projects.</p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$rel</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-c">//Entry below specifies that an author can have one or more posts (ie. a has-many relationship).</span></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>relation_type<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">\LeanOrm\</span><span class="pl-c1">Model</span><span class="pl-k">::</span><span class="pl-c1">RELATION_TYPE_HAS_MANY</span>,</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_key_col_in_my_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_key_col_in_foreign_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>primary_key_col_in_foreign_table<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>post_id<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_models_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>PostsModel<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_models_collection_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>PostsCollection<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>foreign_models_record_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>PostRecord<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">            ]</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$authors_model</span> <span class="pl-k">=</span> </span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">\LeanOrm\</span><span class="pl-c1">Model</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">"</span>mysql:some-host-name;dbname=blog<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">"</span>username<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1">        [<span class="pl-c1">PDO</span><span class="pl-k">::</span><span class="pl-c1">MYSQL_ATTR_INIT_COMMAND</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>SET NAMES utf8<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">        [</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>primary_col<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, </span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>table_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>authors<span class="pl-pds">'</span></span>, </span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>relations<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$rel</span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>created_timestamp_column_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>updated_timestamp_column_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>m_timestamp<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>collection_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>AuthorsCollection<span class="pl-pds">'</span></span>, <span class="pl-c">//If not set, \LeanOrm\Model\Collection will be used by default</span></span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>record_class_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>AuthorRecord<span class="pl-pds">'</span></span>, <span class="pl-c">//If not set, \LeanOrm\Model\Record will be used by default </span></span>
<span class="pl-s1">        ]</span>
<span class="pl-s1">    );</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
</ul>

<blockquote>
<p>For both methods, you can decide if you want to use the base Record and Collection classes (<strong>\LeanOrm\Model\Collection</strong> and <strong>\LeanOrm\Model\Record</strong> (or <strong>\LeanOrm\Model\ReadOnlyRecord</strong> if needed) ) or if you want to extend the base Record and Collection classes eg:</p>
</blockquote>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">AuthorsCollection</span> <span class="pl-k">extends</span> <span class="pl-c1">\LeanOrm\Model\</span><span class="pl-e">Collection</span> {</span>
<span class="pl-s1">   <span class="pl-c">//some custom code for collection objects that are meant to hold records belonging to the 'authors' database table</span></span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">AuthorsRecord</span> <span class="pl-k">extends</span> <span class="pl-c1">\LeanOrm\Model\</span><span class="pl-e">Record</span> {</span>
<span class="pl-s1">   <span class="pl-c">//some custom code for records belonging to the 'authors' database table</span></span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>

<h3>
<a id="creating-records--inserting-data-into-the-database" class="anchor" href="#creating-records--inserting-data-into-the-database" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creating Records &amp; Inserting Data into the Database</h3>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Method 1:</span></span>
<span class="pl-s1">    <span class="pl-smi">$new_record</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>createNewRecord(); <span class="pl-c">//create a blank new record</span></span>
<span class="pl-s1">    <span class="pl-smi">$new_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span>; <span class="pl-c">//set a value for the 'name' column</span></span>
<span class="pl-s1">    <span class="pl-smi">$new_record</span><span class="pl-k">-&gt;</span>save();<span class="pl-c">//save to the database</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Method 2:</span></span>
<span class="pl-s1">    <span class="pl-c">//create a new record and set a value for the 'name' column</span></span>
<span class="pl-s1">    <span class="pl-smi">$new_record</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>createNewRecord([ <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span>]); </span>
<span class="pl-s1">    <span class="pl-smi">$new_record</span><span class="pl-k">-&gt;</span>save();<span class="pl-c">//save to the database</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Method 3:</span></span>
<span class="pl-s1">    <span class="pl-c">//$inserted_data is an associative array of the data just inserted into the </span></span>
<span class="pl-s1">    <span class="pl-c">//database. This data will include an auto-generated primary key value and </span></span>
<span class="pl-s1">    <span class="pl-c">//values of the columns that keep track of the time the record was inserted </span></span>
<span class="pl-s1">    <span class="pl-c">//and last updated (if the $_created_timestamp_column_name and </span></span>
<span class="pl-s1">    <span class="pl-c">//$_updated_timestamp_column_name were correctly set).</span></span>
<span class="pl-s1">    <span class="pl-smi">$inserted_data</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>insert([ <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span>]);</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Multiple Inserts:</span></span>
<span class="pl-s1">    <span class="pl-c">//Below is the most efficient way insert multiple rows to the database.</span></span>
<span class="pl-s1">    <span class="pl-c">//$all_successfully_inserted will be === true if all the inserts were</span></span>
<span class="pl-s1">    <span class="pl-c">//successful, otherwise it will be  === false which means the multiple</span></span>
<span class="pl-s1">    <span class="pl-c">//insert was unsuccessful (nothing is saved to the DB in this case).</span></span>
<span class="pl-s1">    <span class="pl-smi">$all_successfully_inserted</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>insertMany([ [<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span>], [<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Jane Doe<span class="pl-pds">'</span></span>] ]);</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//NOTE: if you have a collection (an instance of \LeanOrm\Model\Collection) </span></span>
<span class="pl-s1">    <span class="pl-c">//      containing 2 or more records you can also efficiently save the records </span></span>
<span class="pl-s1">    <span class="pl-c">//      by calling \LeanOrm\Model\Collection::save(true). See the documentation</span></span>
<span class="pl-s1">    <span class="pl-c">//      for Collections for more details.</span></span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>

<h3>
<a id="fetching-data-from-the-database---parameter-definition" class="anchor" href="#fetching-data-from-the-database---parameter-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fetching data from the Database - Parameter Definition</h3>

<p>There are seven Model methods for fetching data from the database:</p>

<ul>
<li>
<p><em><strong>fetchCol(array $params = array()):</strong></em></p>

<blockquote>
<p>selects data from a single database table's column and returns an array of the column values.</p>
</blockquote>
</li>
<li>
<p><em><strong>fetchOneRecord(array $params = array()):</strong></em></p>

<blockquote>
<p>selects a single row of data from a database table and returns it as an instance of \LeanOrm\Model\Record (or any of its subclasses).</p>
</blockquote>
</li>
<li>
<p><em><strong>fetchPairs(array $params = array()):</strong></em></p>

<blockquote>
<p>selects data from two database table columns and returns an array whose keys are values from the first column and whose values are the values from the second column.</p>
</blockquote>
</li>
<li>
<p><em><strong>fetchRecordsIntoArray(array $params = array()):</strong></em></p>

<blockquote>
<p>selects one or more rows of data from a database table and returns them as instances of \LeanOrm\Model\Record (or any of its subclasses) inside an array.</p>
</blockquote>
</li>
<li>
<p><em><strong>fetchRecordsIntoCollection(array $params = array()):</strong></em></p>

<blockquote>
<p>selects one or more rows of data from a database table and returns them as instances of \LeanOrm\Model\Record (or any of its subclasses) inside an instance of \LeanOrm\Model\Collection (or any of its subclasses).</p>
</blockquote>
</li>
<li>
<p><em><strong>fetchRowsIntoArray(array $params = array()):</strong></em></p>

<blockquote>
<p>selects one or more rows of data from a database table and returns them as associative arrays inside an array.</p>
</blockquote>
</li>
<li>
<p><em><strong>fetchValue(array $params = array()):</strong></em></p>

<blockquote>
<p>selects a single value from a single column of a single row of data from a database table and returns the value (eg. as a string, or an appropriate data type). </p>
</blockquote>
</li>
</ul>

<p>They all accept one parameter; an associative array (<strong>$params</strong>) for specifying how the data should be retrieved. Below is the specification for the structure of the array:</p>

<ul>
<li>
<p><strong>relations_to_include</strong>: this entry in the <strong>$params</strong> array should contain an array of relation names defined for a specific model. For example, the definition below would be valid for the AuthorsModel defined earlier in this document:</p>

<blockquote>
<p><em><strong>$params=["relations_to_include"=&gt;['posts']];</strong></em></p>
</blockquote>
</li>
<li>
<p><strong>distinct</strong>: this entry in the <strong>$params</strong> array should contain a boolean value of <strong>true</strong> if the <strong>DISTINCT</strong> keyword should be added to the SELECT statement that will be generated by the fetch method to fetch data or <strong>false</strong> if the <strong>DISTINCT</strong> keyword should be ommitted. For example, the definition below would be valid for the AuthorsModel defined earlier in this document:</p>

<blockquote>
<p><em><strong>$params=["distinct"=&gt;true];</strong></em></p>
</blockquote>
</li>
<li>
<p><strong>cols</strong>: this entry in the <strong>$params</strong> array should contain an array of the name(s) of column(s) to be returned in the data returned by the fetch method. If this entry is not set in the <strong>$params</strong> array, all columns will be returned in the result of the fetch method if applicable. For example, the definition below would be valid for the AuthorsModel defined earlier in this document:</p>

<blockquote>
<p><em><strong>$params=["cols"=&gt;['author_id', 'name']];</strong></em></p>
</blockquote>
</li>
<li>
<p><strong>where</strong>: this entry in the <strong>$params</strong> array should contain an array of parameters for building a WHERE clause to be added to the SELECT statement that will be generated by the fetch method to fetch data. For example, the definitions below would be valid for the AuthorsModel defined earlier in this document:</p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>where<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> </span>
<span class="pl-s1">        [</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">        ]</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//Generates the WHERE clause below:</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    WHERE</span></span>
<span class="pl-s1"><span class="pl-c">    (</span></span>
<span class="pl-s1"><span class="pl-c">        name = 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">        AND author_id &gt; '2' </span></span>
<span class="pl-s1"><span class="pl-c">        AND date_created &gt;= '2015-08-19 14:24:48' </span></span>
<span class="pl-s1"><span class="pl-c">    )</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>where<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> </span>
<span class="pl-s1">        [</span>
<span class="pl-s1">            [</span>
<span class="pl-s1">                [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">            ],</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>OR<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">                       [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>!=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                       [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&lt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">50</span> ]</span>
<span class="pl-s1">                   ],</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>OR#2<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">                        [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Jane Doe<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                        [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>not-in<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span>[<span class="pl-c1">58</span>, <span class="pl-c1">65</span>] ],</span>
<span class="pl-s1">                     ]</span>
<span class="pl-s1">        ]</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//Generates the WHERE clause below:</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">WHERE</span></span>
<span class="pl-s1"><span class="pl-c">    (</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name = 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id &gt; 2 </span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">        OR</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name &lt;&gt; 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id &gt; 50</span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">        AND date_created &gt;= '2015-08-19 14:24:48' </span></span>
<span class="pl-s1"><span class="pl-c">        OR</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name = 'Jane Doe' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id NOT IN  (58,65)  </span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    )</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 1: The 'op' could be assigned any one of these values:</span></span>
<span class="pl-s1"><span class="pl-c">// '=', '&gt;', '&gt;=', '&lt;', '&lt;=', 'in', 'is-null', 'like', '!=', 'not-in', 'not-like', 'not-null'</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 2: For multiple OR conditions, append a # and a unique string after </span></span>
<span class="pl-s1"><span class="pl-c">// the # to the OR key so that the subsequent OR condition(s) do not override  </span></span>
<span class="pl-s1"><span class="pl-c">// the previous ones. </span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 3: Do not to make the first key in the 'where' array or the first key </span></span>
<span class="pl-s1"><span class="pl-c">// in any of the array(s) inside the 'where' array an 'OR' or 'OR#...' key.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 4: For any sub-array containing an item with a key named 'op' with a </span></span>
<span class="pl-s1"><span class="pl-c">// value of either 'not-null' or 'is-null', there must not be any item in that </span></span>
<span class="pl-s1"><span class="pl-c">// sub-array with a key named 'val', but there must be a corresponding item </span></span>
<span class="pl-s1"><span class="pl-c">// with a key named 'col' with a string value.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 5: The operators: 'in' and 'not-in' allow 'val' to be set to an array </span></span>
<span class="pl-s1"><span class="pl-c">// or string value. If 'val' is a string, it must be a valid value that a </span></span>
<span class="pl-s1"><span class="pl-c">// NOT IN or IN operator expects including the opening and closing brackets. </span></span>
<span class="pl-s1"><span class="pl-c">// Eg. "( 1, 2, 3 )" or "( '4', '5', '6' )".</span></span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>group</strong>: this entry in the <strong>$params</strong> array should contain an array of the name(s) of column(s) for building a GROUP BY clause to be added to the SELECT statement that will be generated by the fetch method to fetch data. For example, the definition below would be valid for the AuthorsModel defined earlier in this document:</p>

<blockquote>
<p><em><strong>$params=['group' =&gt; ['name']];</strong></em> generates <em><strong>GROUP BY name</strong></em></p>
</blockquote>
</li>
<li>
<p><strong>having</strong>: this entry in the <strong>$params</strong> array should contain an array of parameters for building a HAVING clause to be added to the SELECT statement that will be generated by the fetch method to fetch data. For example, the definitions below would be valid for the AuthorsModel defined earlier in this document:</p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>having<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> </span>
<span class="pl-s1">        [</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">        ]</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//Generates the HAVING clause below:</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    HAVING</span></span>
<span class="pl-s1"><span class="pl-c">    (</span></span>
<span class="pl-s1"><span class="pl-c">        name = 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">        AND author_id &gt; '2' </span></span>
<span class="pl-s1"><span class="pl-c">        AND date_created &gt;= '2015-08-19 14:24:48' </span></span>
<span class="pl-s1"><span class="pl-c">    )</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>having<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> </span>
<span class="pl-s1">        [</span>
<span class="pl-s1">            [</span>
<span class="pl-s1">                [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">            ],</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>OR<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">                       [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>!=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                       [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&lt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">50</span> ]</span>
<span class="pl-s1">                   ],</span>
<span class="pl-s1">            [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>OR#2<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">                        [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Jane Doe<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                        [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>not-in<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span>[<span class="pl-c1">58</span>, <span class="pl-c1">65</span>] ],</span>
<span class="pl-s1">                     ]</span>
<span class="pl-s1">        ]</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//Generates the HAVING clause below:</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">HAVING</span></span>
<span class="pl-s1"><span class="pl-c">    (</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name = 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id &gt; 2 </span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">        OR</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name &lt;&gt; 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id &gt; 50</span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">        AND date_created &gt;= '2015-08-19 14:24:48' </span></span>
<span class="pl-s1"><span class="pl-c">        OR</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name = 'Jane Doe' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id NOT IN  (58,65)  </span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    )</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 1: The 'op' could be assigned any one of these values:</span></span>
<span class="pl-s1"><span class="pl-c">// '=', '&gt;', '&gt;=', '&lt;', '&lt;=', 'in', 'is-null', 'like', '!=', 'not-in', 'not-like', 'not-null'</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 2: For multiple OR conditions, append a # and a unique string after </span></span>
<span class="pl-s1"><span class="pl-c">// the # to the OR key so that the subsequent OR condition(s) do not override  </span></span>
<span class="pl-s1"><span class="pl-c">// the previous ones. </span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 3: Do not to make the first key in the 'having' array or the first key </span></span>
<span class="pl-s1"><span class="pl-c">// in any of the array(s) inside the 'having' array an 'OR' or 'OR#...' key.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 4: For any sub-array containing an item with a key named 'op' with a </span></span>
<span class="pl-s1"><span class="pl-c">// value of either 'not-null' or 'is-null', there must not be any item in that </span></span>
<span class="pl-s1"><span class="pl-c">// sub-array with a key named 'val', but there must be a corresponding item </span></span>
<span class="pl-s1"><span class="pl-c">// with a key named 'col' with a string value.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// NOTE 5: The operators: 'in' and 'not-in' allow 'val' to be set to an array </span></span>
<span class="pl-s1"><span class="pl-c">// or string value. If 'val' is a string, it must be a valid value that a </span></span>
<span class="pl-s1"><span class="pl-c">// NOT IN or IN operator expects including the opening and closing brackets. </span></span>
<span class="pl-s1"><span class="pl-c">// Eg. "( 1, 2, 3 )" or "( '4', '5', '6' )".</span></span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>order</strong>: this entry in the <strong>$params</strong> array should contain an array of parameters for building an ORDER BY clause to be added to the SELECT statement that will be generated by the fetch method to fetch data. For example, the definition below would be valid for the AuthorsModel defined earlier in this document:</p>

<blockquote>
<p><em><strong>$params = [ 'order' =&gt; ['name DESC'] ];</strong></em> generates <em><strong>ORDER BY name DESC</strong></em></p>
</blockquote>
</li>
<li>
<p><strong>limit_size</strong>: this entry in the <strong>$params</strong> array should contain an int value for building a LIMIT clause to be added to the SELECT statement that will be generated by the fetch method to fetch data. For example, the definition below would be valid for the AuthorsModel defined earlier in this document:</p>

<blockquote>
<p><em><strong>$params = [ 'limit_size'=&gt;50 ];</strong></em> generates <em><strong>LIMIT 50</strong></em> for a mysql database. It would be different for MS SQLServer.</p>
</blockquote>
</li>
<li>
<p><strong>limit_offset</strong>: this entry in the <strong>$params</strong> array should contain an int value for building the OFFSET part of the LIMIT clause to be added to the SELECT statement that will be generated by the fetch method to fetch data. It has no effect when <strong>limit_size</strong> has not been set. For example, the definition below would be valid for the AuthorsModel defined earlier in this document:</p>

<blockquote>
<p><em><strong>$params = [ 'limit_offset' =&gt; 10, 'limit_size'=&gt;50 ];</strong></em> generates <em><strong>LIMIT 50 OFFSET 10</strong></em> for a mysql database. It would be different for MS SQLServer (ie. <em>** OFFSET $params['limit_offset'] ROWS FETCH NEXT $params['limit_size'] ROWS ONLY**</em>).</p>
</blockquote>
</li>
</ul>

<h3>
<a id="fetching-data-from-the-database---data-retreival" class="anchor" href="#fetching-data-from-the-database---data-retreival" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fetching data from the Database - Data Retreival</h3>

<ul>
<li>
<p><strong>Fetching data as Records into a Collection (via fetchRecordsIntoCollection):</strong></p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>distinct<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>cols<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>where<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>group<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>having<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>order<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [<span class="pl-s"><span class="pl-pds">'</span>name DESC<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit_offset<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit_size<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">50</span>,</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The $params array above causes any of the fetch* methods to generate the SQL </span></span>
<span class="pl-s1"><span class="pl-c">//statement below (which would be used by the fetch* method to retrieve data from the DB):</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    SELECT DISTINCT author_id, name, date_created</span></span>
<span class="pl-s1"><span class="pl-c">    FROM</span></span>
<span class="pl-s1"><span class="pl-c">        `authors`</span></span>
<span class="pl-s1"><span class="pl-c">    WHERE</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name = 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id &gt; 2 </span></span>
<span class="pl-s1"><span class="pl-c">            AND date_created &gt;= '2015-08-19 14:24:48'</span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    GROUP BY name</span></span>
<span class="pl-s1"><span class="pl-c">    HAVING</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            date_created &gt;= '2015-08-19 14:24:48' </span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    ORDER BY name DESC</span></span>
<span class="pl-s1"><span class="pl-c">    LIMIT 50;</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The fetchRecordsIntoCollection call below returns an instance </span></span>
<span class="pl-s1"><span class="pl-c">//of \LeanOrm\Model\Collection containing one or more instances of</span></span>
<span class="pl-s1"><span class="pl-c">//\LeanOrm\Model\Record each containing a row of data from the row(s)</span></span>
<span class="pl-s1"><span class="pl-c">//returned by executing the generated select query above.</span></span>
<span class="pl-s1"><span class="pl-smi">$collection_of_authors</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRecordsIntoCollection(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can loop through the collection like so:</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$collection_of_authors</span> <span class="pl-k">as</span> <span class="pl-smi">$collection_key</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$author_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">author_id</span>}, name: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">name</span>} , date_created: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">date_created</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Accessing a db table columns in a record object using array syntax also works like below:</span></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>]}, name: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>]} , date_created: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>]} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//To return all the rows in a db table, call fetchRecordsIntoCollection with </span></span>
<span class="pl-s1"><span class="pl-c">//no parameters. In this case fetchRecordsIntoCollection will just perform a </span></span>
<span class="pl-s1"><span class="pl-c">//"SELECT authors.* FROM `authors`" query and return all the rows of data in</span></span>
<span class="pl-s1"><span class="pl-c">//the authors table.</span></span>
<span class="pl-s1"><span class="pl-smi">$collection_of_all_authors</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRecordsIntoCollection();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//To return related data (if any) defined in the Model's _relations array,</span></span>
<span class="pl-s1"><span class="pl-c">//add a 'relations_to_include' entry to the $params array defined ealier</span></span>
<span class="pl-s1"><span class="pl-c">//above. For example, to get the posts belonging to an author (note that</span></span>
<span class="pl-s1"><span class="pl-c">//this relationship has been defined in the AuthorsModel class earlier</span></span>
<span class="pl-s1"><span class="pl-c">//above) modify the $params array like so:</span></span>
<span class="pl-s1"><span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>relations_to_include<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1"><span class="pl-smi">$collection_of_authors_with_posts</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRecordsIntoCollection(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can loop through the collection like so:</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$collection_of_authors_with_posts</span> <span class="pl-k">as</span> <span class="pl-smi">$collection_key</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$author_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">author_id</span>}, name: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">name</span>} , date_created: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">date_created</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Access the posts</span></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> Posts: &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//In this case, $author_record-&gt;posts will be an instance of PostsCollection</span></span>
<span class="pl-s1">    <span class="pl-c">//and each $post_record will be an instance of PostRecord based on the </span></span>
<span class="pl-s1">    <span class="pl-c">//relationship definintion in the AuthorsModel class.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">foreach</span>(<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">posts</span> <span class="pl-k">as</span> <span class="pl-smi">$post_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> post_id: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">post_id</span>}, title: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">title</span>} , body: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">body</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>Fetching data as Records into an array (via fetchRecordsIntoArray ):</strong> Use this method if you don't need to call any of the Collection methods on the returned data. <strong>fetchRecordsIntoArray</strong> executes slightly faster than <strong>fetchRecordsIntoCollection</strong> and is also slightly more memory efficient than <strong>fetchRecordsIntoCollection</strong>.</p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>distinct<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>cols<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>where<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>group<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>having<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>order<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [<span class="pl-s"><span class="pl-pds">'</span>name DESC<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit_offset<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit_size<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">50</span>,</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The $params array above causes any of the fetch* methods to generate the SQL </span></span>
<span class="pl-s1"><span class="pl-c">//statement below (which would be used by the fetch* method to retrieve data from the DB):</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    SELECT DISTINCT author_id, name, date_created</span></span>
<span class="pl-s1"><span class="pl-c">    FROM</span></span>
<span class="pl-s1"><span class="pl-c">        `authors`</span></span>
<span class="pl-s1"><span class="pl-c">    WHERE</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name = 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id &gt; 2 </span></span>
<span class="pl-s1"><span class="pl-c">            AND date_created &gt;= '2015-08-19 14:24:48'</span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    GROUP BY name</span></span>
<span class="pl-s1"><span class="pl-c">    HAVING</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            date_created &gt;= '2015-08-19 14:24:48' </span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    ORDER BY name DESC</span></span>
<span class="pl-s1"><span class="pl-c">    LIMIT 50;</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The fetchRecordsIntoArray call below returns an array containing one or more </span></span>
<span class="pl-s1"><span class="pl-c">//instances of \LeanOrm\Model\Record each containing a row of data from the </span></span>
<span class="pl-s1"><span class="pl-c">//row(s) returned by executing the generated select query above.</span></span>
<span class="pl-s1"><span class="pl-smi">$array_of_author_records</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRecordsIntoArray(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can loop through the array like so:</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$array_of_author_records</span> <span class="pl-k">as</span> <span class="pl-smi">$array_key</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$author_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">author_id</span>}, name: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">name</span>} , date_created: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">date_created</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Accessing a db table columns in a record object using array syntax also works like below:</span></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>]}, name: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>]} , date_created: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>]} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//To return all the rows in a db table, call fetchRecordsIntoArray with </span></span>
<span class="pl-s1"><span class="pl-c">//no parameters. In this case fetchRecordsIntoArray will just perform a </span></span>
<span class="pl-s1"><span class="pl-c">//"SELECT authors.* FROM `authors`" query and return all the rows of data in</span></span>
<span class="pl-s1"><span class="pl-c">//the authors table.</span></span>
<span class="pl-s1"><span class="pl-smi">$array_of_all_author_records</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRecordsIntoArray();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//To return related data (if any) defined in the Model's _relations array,</span></span>
<span class="pl-s1"><span class="pl-c">//add a 'relations_to_include' entry to the $params array defined ealier</span></span>
<span class="pl-s1"><span class="pl-c">//above. For example, to get the posts belonging to an author (note that</span></span>
<span class="pl-s1"><span class="pl-c">//this relationship has been defined in the AuthorsModel class earlier</span></span>
<span class="pl-s1"><span class="pl-c">//above) modify the $params array like so:</span></span>
<span class="pl-s1"><span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>relations_to_include<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1"><span class="pl-smi">$array_of_authors_with_posts</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRecordsIntoArray(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can loop through the array like so:</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$array_of_authors_with_posts</span> <span class="pl-k">as</span> <span class="pl-smi">$array_key</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$author_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">author_id</span>}, name: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">name</span>} , date_created: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">date_created</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Access the posts</span></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> Posts: &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//In this case, $author_record-&gt;posts will be an array.</span></span>
<span class="pl-s1">    <span class="pl-c">//Each $post_record will be an instance of PostRecord based on the </span></span>
<span class="pl-s1">    <span class="pl-c">//relationship definintion in the AuthorsModel class.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">foreach</span>(<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">posts</span> <span class="pl-k">as</span> <span class="pl-smi">$post_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> post_id: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">post_id</span>}, title: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">title</span>} , body: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">body</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>Fetching data as arrays into an array (via fetchRowsIntoArray ):</strong> Use this method if you don't need to call any of the Collection or Record methods on the returned data. <strong>fetchRowsIntoArray</strong> executes faster than <strong>fetchRecordsIntoArray</strong> and <strong>fetchRecordsIntoCollection</strong> and is also more memory efficient than <strong>fetchRecordsIntoArray</strong> and <strong>fetchRecordsIntoCollection</strong>.</p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>distinct<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>cols<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>where<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>Joe Blow<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>group<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>having<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>&gt;=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>2015-08-19 14:24:48<span class="pl-pds">'</span></span> ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>order<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [<span class="pl-s"><span class="pl-pds">'</span>name DESC<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit_offset<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">0</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit_size<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">50</span>,</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The $params array above causes any of the fetch* methods to generate the SQL </span></span>
<span class="pl-s1"><span class="pl-c">//statement below (which would be used by the fetch* method to retrieve data from the DB):</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    SELECT DISTINCT author_id, name, date_created</span></span>
<span class="pl-s1"><span class="pl-c">    FROM</span></span>
<span class="pl-s1"><span class="pl-c">        `authors`</span></span>
<span class="pl-s1"><span class="pl-c">    WHERE</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            name = 'Joe Blow' </span></span>
<span class="pl-s1"><span class="pl-c">            AND author_id &gt; 2 </span></span>
<span class="pl-s1"><span class="pl-c">            AND date_created &gt;= '2015-08-19 14:24:48'</span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    GROUP BY name</span></span>
<span class="pl-s1"><span class="pl-c">    HAVING</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            date_created &gt;= '2015-08-19 14:24:48' </span></span>
<span class="pl-s1"><span class="pl-c">        )</span></span>
<span class="pl-s1"><span class="pl-c">    ORDER BY name DESC</span></span>
<span class="pl-s1"><span class="pl-c">    LIMIT 50;</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The fetchRowsIntoArray call below returns an array containing one or more </span></span>
<span class="pl-s1"><span class="pl-c">//array(s) each containing a row of data from the row(s) returned by </span></span>
<span class="pl-s1"><span class="pl-c">//executing the generated select query above.</span></span>
<span class="pl-s1"><span class="pl-smi">$array_of_authors</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRowsIntoArray(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can loop through the array like so:</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$array_of_authors</span> <span class="pl-k">as</span> <span class="pl-smi">$array_key</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$array_of_author_data</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$array_of_author_data</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>]}, name: {<span class="pl-smi">$array_of_author_data</span>[<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>]} , date_created: {<span class="pl-smi">$array_of_author_data</span>[<span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>]} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//To return all the rows in a db table, call fetchRowsIntoArray with </span></span>
<span class="pl-s1"><span class="pl-c">//no parameters. In this case fetchRowsIntoArray will just perform a </span></span>
<span class="pl-s1"><span class="pl-c">//"SELECT authors.* FROM `authors`" query and return all the rows of data in</span></span>
<span class="pl-s1"><span class="pl-c">//the authors table.</span></span>
<span class="pl-s1"><span class="pl-smi">$array_of_all_authors</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRowsIntoArray();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//To return related data (if any) defined in the Model's _relations array,</span></span>
<span class="pl-s1"><span class="pl-c">//add a 'relations_to_include' entry to the $params array defined ealier</span></span>
<span class="pl-s1"><span class="pl-c">//above. For example, to get the posts belonging to an author (note that</span></span>
<span class="pl-s1"><span class="pl-c">//this relationship has been defined in the AuthorsModel class earlier</span></span>
<span class="pl-s1"><span class="pl-c">//above) modify the $params array like so:</span></span>
<span class="pl-s1"><span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>relations_to_include<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1"><span class="pl-smi">$array_of_authors_with_posts</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchRowsIntoArray(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can loop through the array like so:</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$array_of_authors_with_posts</span> <span class="pl-k">as</span> <span class="pl-smi">$array_key</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$array_of_author_data</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$array_of_author_data</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>]}, name: {<span class="pl-smi">$array_of_author_data</span>[<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>]} , date_created: {<span class="pl-smi">$array_of_author_data</span>[<span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>]} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//Access the posts</span></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> Posts: &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">//In this case, $array_of_author_data['posts'] will be an array.</span></span>
<span class="pl-s1">    <span class="pl-c">//Each $post_record will be an array containing a row of data from the</span></span>
<span class="pl-s1">    <span class="pl-c">//posts db table. The related data is retrieved based on the relationship </span></span>
<span class="pl-s1">    <span class="pl-c">//definintion in the AuthorsModel class.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">foreach</span>(<span class="pl-smi">$array_of_author_data</span>[<span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>] <span class="pl-k">as</span> <span class="pl-smi">$post_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">        <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> post_id: {<span class="pl-smi">$post_record</span>[<span class="pl-s"><span class="pl-pds">'</span>post_id<span class="pl-pds">'</span></span>]}, title: {<span class="pl-smi">$post_record</span>[<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>]} , body: {<span class="pl-smi">$post_record</span>[<span class="pl-s"><span class="pl-pds">'</span>body<span class="pl-pds">'</span></span>]} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>Fetching one row of data as a Record (via fetchOneRecord):</strong></p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>cols<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>where<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2</span> ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The $params array above causes any of the fetch* methods to generate the SQL </span></span>
<span class="pl-s1"><span class="pl-c">//statement below (which would be used by the fetch* method to retrieve data from the DB):</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    SELECT author_id, name, date_created</span></span>
<span class="pl-s1"><span class="pl-c">      FROM `authors`</span></span>
<span class="pl-s1"><span class="pl-c">     WHERE</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            author_id = 2</span></span>
<span class="pl-s1"><span class="pl-c">        );</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//fetchOneRecord returns an instance of \LeanOrm\Model\Record from the first </span></span>
<span class="pl-s1"><span class="pl-c">//row returned by executing the generated select query above. </span></span>
<span class="pl-s1"><span class="pl-c">//In this case the first db table row having an author_id value of 2 is </span></span>
<span class="pl-s1"><span class="pl-c">//returned as an instance of AuthorRecord which is a sub-class of</span></span>
<span class="pl-s1"><span class="pl-c">//\LeanOrm\Model\Record because the _record_class_name property of the</span></span>
<span class="pl-s1"><span class="pl-c">//AuthorsModel class was set to 'AuthorRecord'.</span></span>
<span class="pl-s1"><span class="pl-smi">$author_record</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchOneRecord(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can access the fetched data like so using object notation:</span></span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">author_id</span>}, name: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">name</span>} , date_created: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">date_created</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can access the fetched data like so using array syntax:</span></span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>]}, name: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>]} , date_created: {<span class="pl-smi">$author_record</span>[<span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>]} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//Calling fetchOneRecord with no parameters returns an instance of </span></span>
<span class="pl-s1"><span class="pl-c">//\LeanOrm\Model\Record from the first row returned by executing </span></span>
<span class="pl-s1"><span class="pl-c">//"SELECT authors.* FROM `authors`". In this case an instance of </span></span>
<span class="pl-s1"><span class="pl-c">//AuthorRecord is returned.</span></span>
<span class="pl-s1"><span class="pl-smi">$author_record</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchOneRecord();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//To return related data (if any) defined in the Model's _relations array,</span></span>
<span class="pl-s1"><span class="pl-c">//add a 'relations_to_include' entry to the $params array defined ealier</span></span>
<span class="pl-s1"><span class="pl-c">//above. For example, to get the posts belonging to an author (note that</span></span>
<span class="pl-s1"><span class="pl-c">//this relationship has been defined in the AuthorsModel class earlier</span></span>
<span class="pl-s1"><span class="pl-c">//above) modify the $params array like so:</span></span>
<span class="pl-s1"><span class="pl-smi">$params</span>[<span class="pl-s"><span class="pl-pds">'</span>relations_to_include<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>posts<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1"><span class="pl-smi">$author_record</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchOneRecord(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//You can access the fetched data like so using object notation:</span></span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> author_id: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">author_id</span>}, name: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">name</span>} , date_created: {<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">date_created</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//Access the posts</span></span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> Posts: &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//In this case, $author_record-&gt;posts will be an instance of PostsCollection</span></span>
<span class="pl-s1"><span class="pl-c">//and each $post_record will be an instance of PostRecord based on the </span></span>
<span class="pl-s1"><span class="pl-c">//relationship definintion in the AuthorsModel class.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">foreach</span>(<span class="pl-smi">$author_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">posts</span> <span class="pl-k">as</span> <span class="pl-smi">$post_record</span>) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span> post_id: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">post_id</span>}, title: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">title</span>} , body: {<span class="pl-smi">$post_record</span><span class="pl-k">-&gt;</span><span class="pl-smi">body</span>} &lt;br&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>Fetching data from two db table columns into an array (via fetchPairs), where values from the first column will be the keys in the returned array and the values from the second column will be the corresponding values in the returned array:</strong></p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$params</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">"</span>cols<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>date_created<span class="pl-pds">'</span></span>],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>where<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span>  [</span>
<span class="pl-s1">                    [ <span class="pl-s"><span class="pl-pds">'</span>col<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>author_id<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>op<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">'</span>in<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>val<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span>[<span class="pl-c1">1</span>,<span class="pl-c1">3</span>] ],</span>
<span class="pl-s1">                ],</span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//The $params array above causes any of the fetch* methods to generate the SQL </span></span>
<span class="pl-s1"><span class="pl-c">//statement below (which would be used by the fetch* method to retrieve data from the DB):</span></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    SELECT author_id, name, date_created</span></span>
<span class="pl-s1"><span class="pl-c">      FROM `authors`</span></span>
<span class="pl-s1"><span class="pl-c">     WHERE</span></span>
<span class="pl-s1"><span class="pl-c">        (</span></span>
<span class="pl-s1"><span class="pl-c">            author_id IN  (1,3)</span></span>
<span class="pl-s1"><span class="pl-c">        );</span></span>
<span class="pl-s1"><span class="pl-c">*/</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    ---------------------------------------------------------------------------</span></span>
<span class="pl-s1"><span class="pl-c">    | author_id |     name    |       m_timestamp     |   date_created        |</span></span>
<span class="pl-s1"><span class="pl-c">    ---------------------------------------------------------------------------</span></span>
<span class="pl-s1"><span class="pl-c">    |     1     | 'Joe Blow'  | '2015-08-19 14:24:48' | '2015-08-19 14:24:48' |</span></span>
<span class="pl-s1"><span class="pl-c">    ---------------------------------------------------------------------------</span></span>
<span class="pl-s1"><span class="pl-c">    |     2     | 'Jack Doe'  | '2015-08-19 14:24:48' | '2015-08-19 14:24:48' |</span></span>
<span class="pl-s1"><span class="pl-c">    ---------------------------------------------------------------------------</span></span>
<span class="pl-s1"><span class="pl-c">    |     3     | 'Jane Doe'  | '2015-08-19 14:24:48' | '2015-08-19 14:24:48' |</span></span>
<span class="pl-s1"><span class="pl-c">    ---------------------------------------------------------------------------</span></span>
<span class="pl-s1"><span class="pl-c"></span></span>
<span class="pl-s1"><span class="pl-c">    Given an authors db table containing the data above calling fetchPairs </span></span>
<span class="pl-s1"><span class="pl-c">    like below will return [ 1=&gt;'Joe Blow', 3=&gt;'Jane Doe']:</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-smi">$data</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchPairs(<span class="pl-smi">$params</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/*</span></span>
<span class="pl-s1"><span class="pl-c">    Given an authors db table containing the data above calling fetchPairs </span></span>
<span class="pl-s1"><span class="pl-c">    like below will return [ 1=&gt;'Joe Blow', 2=&gt;'Jack Doe', 3=&gt;'Jane Doe']:</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-smi">$data</span> <span class="pl-k">=</span> <span class="pl-smi">$authors_model</span><span class="pl-k">-&gt;</span>fetchPairs();</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>Fetching data from one db table column into an array (via fetchCol):</strong></p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"></span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
<li>
<p><strong>Fetching data from a single row and column of a db table (via fetchValue):</strong></p>

<div class="highlight highlight-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"></span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span></pre></div>
</li>
</ul>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>Yada Yada Yada.</p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Yada Yada Yada.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/rotexsoft/leanorm">Leanorm</a> is maintained by <a href="https://github.com/rotexsoft">rotexsoft</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
